# AI 错误检查清单

## 重要提示
**每次工具调用后必须执行以下检查！**

这是 AI 自我监控的核心要求，不得跳过或忽略。

---

## 1. execute_command 工具调用后

### 检查项目
- [ ] **检查退出码**：是否为 0（非 0 表示失败）
- [ ] **检查输出**：是否包含错误关键词（如 "error"、"failed"、"not recognized"、"无法"、"错误" 等）
- [ ] **检查命令是否按预期执行**

### 如果检测到失败
**立即执行以下操作**：
1. 分析错误原因
2. 调用 `skill(skill="ai-error-record", args="error_type=命令执行错误; error_description=[具体错误]; root_cause=[原因分析]; solution=[解决方案]")`
3. 向用户报告错误并说明已记录
4. **不得**声称"任务完成"

### 示例
```
命令执行失败后的正确操作：
1. 检测到退出码为 1
2. 输出包含 "'xxx' is not recognized"
3. 调用技能记录错误
4. 向用户说明情况并尝试修复
```

---

## 2. 文件操作工具调用后

### 检查项目
- [ ] **read_file**：文件是否存在，内容是否正确读取
- [ ] **write_to_file**：文件是否成功写入
- [ ] **apply_diff**：修改是否成功应用
- [ ] **list_files**：目录是否存在

### 如果检测到失败
**立即执行以下操作**：
1. 分析错误原因（文件不存在、权限问题、格式错误等）
2. 调用 `skill(skill="ai-error-record", args="error_type=文件操作错误; error_description=[具体错误]; root_cause=[原因分析]; solution=[解决方案]")`
3. 向用户报告错误

### 示例
```
文件操作失败后的正确操作：
1. 检测到 FileNotFoundError
2. 分析原因：文件路径错误或文件不存在
3. 调用技能记录错误
4. 验证文件路径后重试
```

---

## 3. 用户反馈分析

### 检查项目
- [ ] 用户是否提到"错误"、"失败"、"不对"、"有问题"等关键词
- [ ] 用户是否指出 AI 的行为或输出有误
- [ ] 用户是否要求修正或改进

### 如果检测到错误反馈
**立即执行以下操作**：
1. 确认用户指出的问题
2. 调用 `skill(skill="ai-error-record", args="error_type=用户报告错误; error_description=[用户反馈]; root_cause=[待分析]; solution=[待确定]")`
3. 向用户道歉并提出修正方案
4. **不得**辩解或忽略用户反馈

### 示例
```
用户反馈："Roo 测试错误触发是否能自动触发技能时，实际是并没用自动触发"
正确操作：
1. 确认用户指出的问题正确
2. 立即调用技能记录错误
3. 道歉并承认错误
4. 提出修正方案
```

---

## 4. 任务完成前的最终检查

### 在调用 attempt_completion 之前

**必须确认以下条件**：
- [ ] 所有子任务都已完成
- [ ] 所有测试都通过
- [ ] 没有未处理的错误
- [ ] 用户没有未解决的反馈

**如果存在未完成的子任务或错误**：
- **不得**调用 attempt_completion
- **不得**声称"任务完成"
- 继续处理未完成的任务

---

## 5. 错误记录格式

调用 ai-error-record 技能时，使用以下格式：

```
skill(skill="ai-error-record", args="error_type=[错误类型]; error_description=[错误描述]; root_cause=[原因分析]; solution=[解决方案]")
```

### 参数说明
- **error_type**: 错误分类（命令执行错误、文件操作错误、用户报告错误、逻辑错误等）
- **error_description**: 具体错误情况，简洁明了
- **root_cause**: 错误的根本原因分析
- **solution**: 如何避免或解决此错误

---

## 6. 违反清单的后果

违反此检查清单可能导致：
1. 错误未被记录，重复犯错
2. 用户信任度下降
3. 项目质量受损

**请严格遵守此清单！**